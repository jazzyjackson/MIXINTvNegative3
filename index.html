<!-- A flexible, extensible method of prasing XML, HTML, and other plain text data types into a universally readable and reformatabble plain text data tree, or "plain textree"-->

<html>
<head>

<!--
 <link rel="stylesheet" type="text/css" href="./styletree.css">

 <script type="text/javascript" src="./setup.js"></script>
 <script type="text/javascript" src="./behavoir.js"></script>
 <script type="text/javascript" src="./structree.js"></script>
-->
</head>
<body>
      <svg width = "1000" height = "1000">
          <path
          style="fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:4px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;stroke-dasharray:4,4;"
          id="testpath"
          />
      </svg>
      <script> 
        var beginX, beginY, endX, endY, activeElement
        addEventListener('mousedown', function(){setPen(event)})
        addEventListener('mousemove', function(){updatePen(event)})
        addEventListener('mouseup', function(){activeElement = null})
        
        function setPen(event){
            activeElement = "testpath"
            beginX = event.clientX
            beginY = event.clientY
            console.log(beginX + ":" + beginY)
          }
        function updatePen(event){
            if(activeElement == "testpath"){
              endX = event.clientX
              endY = event.clientY
              document.getElementById("testpath").setAttribute("d", buildPath(beginX, beginY, endX, endY))
            }
        }


        function buildPath(x1,y1,x2,y2){
            return "M" + anchorPoint(x1,y1) +  " C "+ controlPointOne(x1,y1,x2,y2) + controlPointTwo(x1,y1,x2,y2) + anchorPoint(x2,y2)
        }
        function anchorPoint(x1,y1){return " " + x1 + "," + y1}
        function controlPointOne(x1,y1,x2,y2){ //isOutput, the orientation of the control points will be dependent on left/right top/down flow  
          var minOffset = Math.abs(y2 - y1)
          var xoffset = x1 + (((x2 - x1)/2) > minOffset ?  ((x2 - x1) / 2): minOffset)
          return " " + xoffset + "," + y1 
        }
        function controlPointTwo(x1,y1,x2,y2){ //isOutput, the orientation of the control points will be dependent on left/right top/down flow  
          var minOffset = Math.abs(y2 - y1)
          var xoffset = (((x2 - x1)/2) > minOffset ? x1 + ((x2 - x1) / 2): x2 - minOffset)
          return " " + xoffset + "," + y2 
        }
      </script>
</body>
</html>

<!--
  Implementation steps:
  Double click to append div to DOM
  fresh div is a text input
  upon deselecting the div (ESC or click on background) swap an input for a span
  
  single click and drag changes relative position
  double click swaps span for input
  right click and dragging on the background move all items
  scrolling scales, oooo
  

  
        var beginX, beginY;
          var testPath = document.getElementById("testpath")
          window.addEventListener('mouseDown', function(){setPen(event);})
          function setPen(event){
            console.log("hello")
            beginX = event.clientX
            beginY = event.clientY
          }
          window.addEventListener('mouseMove', function(){updateLine(event);})
          function updateLine(event){
              testPath.d = "M " + beginX + "," + beginY + " C " + (event.clientX - beginX / 2) + "," + beginY + " " + (event.clientX - beginX / 2) + "," + event.clientY + " " + event.clientX + "," + event.clientY
          }

     