<head>
    <!--<link href="https://fonts.googleapis.com/css?family=VT323" rel="stylesheet">-->
    <link rel="stylesheet" href="/styles/style.css">
    <link rel="stylesheet" href="/styles/menustyle.css">
    <script src="/js/constructors/Leaf.js" defer=""></script>
    <script src="/js/constructors/Terminal.js" defer=""></script>
    <script src="/js/socket.io.js" defer=""></script>
    <script src="/js/socketevents.js" defer=""></script>
    <script src="/js/customCommands.js" defer=""></script>
    <script src="/js/utils.js" defer=""></script>
    
    <script id="repl"></script>
  <link href="/styles/menuStyle.css"><title>todo</title><script src="/js/constructors/Codemirror.js" defer="true"></script><link rel="stylesheet" href="/codemirrorlib/codemirror.css"><script src="/codemirrorlib/codemirror.js" defer="true"></script><link href="/styles/menuStyle.css"><link href="/styles/menuStyle.css"><link href="/styles/menuStyle.css"><link href="/styles/menuStyle.css"><script id="loadscript">
      let scriptArray = Array.from(document.getElementsByTagName('script'));
      let loadingArray = [];
      let firstTerminalIcanFind;
      
      scriptArray.forEach(scriptNode => {
        // console.log(scriptNode)
        let src = scriptNode.getAttribute('src');
        if(src){
          let loadingDiv = document.createElement('div');
          loadingDiv.className = 'result'
          loadingDiv.textContent = `Loading ${src}... `
          loadingArray.push(loadingDiv)
          scriptNode.addEventListener('load', () => {
            loadingDiv.textContent += ' done.'
            console.log('done with ',src)
          })
        }
      })
      document.addEventListener('readystatechange', () => {

        switch(document.readyState){
          case 'interactive': 
            firstTerminalIcanFind = document.querySelector('.terminalContainer');
            loadingArray.forEach(divNode => {
              firstTerminalIcanFind.appendChild(divNode)
            });
            break;
          case 'complete':
            let readyDiv = document.createElement('div')
            readyDiv.className = 'result'
            readyDiv.textContent = 'OK Ready.'
            readyDiv.style.textAlign = 'right'
            firstTerminalIcanFind.appendChild(readyDiv)
            initPrompt(firstTerminalIcanFind);
            break;
        }
      })
      window.addEventListener('load', () => console.log('window loaded'))
      let scriptReArranger = new MutationObserver((info,thisMute)=>{
        console.log("something has changed!", info)
        thisMute.disconnect();
        // mvoeThisScript();
        let thisScript = document.getElementById("loadscript");
        thisScript.remove();
        document.head.appendChild(thisScript)
        thisMute.observe(document.head, {childList: true})
        //this gets caught in an infinite loop.
      })
      scriptReArranger.observe(document.head, {childList: true})
      // function moveThisScript(){
      //   let thisScript = document.getElementById("loadscript");
      //   thisScript.remove();
      //   document.head.appendChild(thisScript)
      // }

    </script></head>
  <!--Giving body id body for consistency with certain functions that rely on div id-->
  <body id="body" style="position: absolute; left: 48px; top: 66px; height: 687px; width: 1137px;">
    <div showmenu="false" broadcast="true" listen="true" style="left: 150px; top: 150px; width: 400px; height: 300px; position: absolute;background: white" tabindex="1" class="leaf terminal" id="todo" history="0" protoprompt="localhost/todo"><div class="entityHeader">
    <table>
      <tbody><tr>
        <td class="headerTitle">todo</td>
      </tr>
    </tbody></table>
    <div class="menuButton"></div>
    <div class="removeButton"></div>
    <div class="menu">
      <ul>
        <li tabindex="2"> Edit <div class="editButton"></div></li>
        <li tabindex="2"> Broadcast <div class="broadcastButton"></div> </li>
        <li tabindex="2"> Listen <div class="listenButton"></div> </li>
        <li tabindex="2"> Save <div class="saveButton"></div> </li>
      </ul>
    </div>
  </div><div class="terminalContainer" history="2"><div class="promptContainer"><span class="prompt">localhost/root0<span class="arrow"></span></span><div class="input"></div></div><div class="result">Loading /js/constructors/Leaf.js...  done.</div><div class="result">Loading /js/constructors/Terminal.js...  done.</div><div class="result">Loading /js/socket.io.js...  done.</div><div class="result">Loading /js/socketevents.js...  done.</div><div class="result">Loading /js/customCommands.js...  done.</div><div class="result">Loading /js/utils.js...  done.</div><div class="result" style="text-align: right;">OK Ready.</div><div class="promptContainer"><span class="prompt">localhost/root0<span class="arrow"></span></span><div class="input">rename todo</div></div><div class="result result" id="1484105923938">root0 has been renamed to todo</div><div class="promptContainer"><span class="prompt">localhost/todo<span class="arrow"></span></span><div class="input">save</div></div><div class="result" id="todo2" createdat="1484105925129">8.58 KB written successfully to todo.html in 38ms</div><div class="promptContainer"><span class="prompt">localhost/todo<span class="arrow"></span></span><div class="input">create Codemirror</div></div><div class="query result" id="1484105927778">Constructor retrieved and invoked, Codemirror0 added to DOM</div><div class="promptContainer"><span class="prompt">localhost/todo<span class="arrow"></span></span><div class="input">create Codemirror</div></div><div class="query result" id="1484106255478">Constructor invoked, Codemirror1 added to DOM</div><div class="promptContainer"><span class="prompt">localhost/todo<span class="arrow"></span></span><div class="input">save</div></div><div class="request result" id="todo2" createdat="1484106339903">Attempting to send file, waiting on response</div><div class="promptContainer"><span class="prompt">localhost/todo<span class="arrow"></span></span><div class="input">save</div></div><div class="request result" id="todo2" createdat="1484106581674">Attempting to send file, waiting on response</div><div class="promptContainer"><span class="prompt">localhost/todo<span class="arrow"></span></span><div class="input">save</div></div><div class="result" id="todo2" createdat="1484110753380">9.45 KB written successfully to todo.html in 161ms</div><div class="promptContainer"><span class="prompt">localhost/todo<span class="arrow"></span></span><div class="input">save</div></div><div class="request" id="todo2" createdat="1484114112968">9.591 KB written successfully to todo.html at Wed Jan 11 2017 00:55:12 GMT-0500 (Eastern Standard Time)</div><div class="promptContainer"><span class="prompt">localhost/todo<span class="arrow"></span></span><div class="input"></div></div><div class="result">Loading /js/constructors/Leaf.js...  done.</div><div class="result">Loading /js/constructors/Terminal.js...  done.</div><div class="result">Loading /js/socket.io.js...  done.</div><div class="result">Loading /js/socketevents.js...  done.</div><div class="result">Loading /js/customCommands.js...  done.</div><div class="result">Loading /js/utils.js...  done.</div><div class="result">Loading /js/constructors/Codemirror.js...  done.</div><div class="result">Loading /codemirrorlib/codemirror.js...  done.</div><div class="result" style="text-align: right;">OK Ready.</div><div class="promptContainer"><span class="prompt">localhost/todo<span class="arrow"></span></span><div class="input">save</div></div><div class="request" id="todo2" createdat="1484164521823">10.815 KB written successfully to todo.html at Wed Jan 11 2017 14:55:21 GMT-0500 (Eastern Standard Time)</div><div class="promptContainer"><span class="prompt">localhost/todo<span class="arrow"></span></span><div class="input"></div></div><div class="result">Loading /js/constructors/Leaf.js...  done.</div><div class="result">Loading /js/constructors/Terminal.js...  done.</div><div class="result">Loading /js/socket.io.js...  done.</div><div class="result">Loading /js/socketevents.js...  done.</div><div class="result">Loading /js/customCommands.js...  done.</div><div class="result">Loading /js/utils.js...  done.</div><div class="result">Loading /js/constructors/Codemirror.js...  done.</div><div class="result">Loading /codemirrorlib/codemirror.js...  done.</div><div class="result" style="text-align: right;">OK Ready.</div><div class="promptContainer"><span class="prompt">localhost/todo<span class="arrow"></span></span><div class="input">save</div></div><div class="request" id="todo2" createdat="1484264066381">12.052 KB written successfully to todo.html at Thu Jan 12 2017 18:34:26 GMT-0500 (Eastern Standard Time)</div><div class="promptContainer"><span class="prompt">localhost/todo<span class="arrow"></span></span><div class="input"></div></div><div class="result">Loading /js/constructors/Leaf.js...  done.</div><div class="result">Loading /js/constructors/Terminal.js...  done.</div><div class="result">Loading /js/socket.io.js...  done.</div><div class="result">Loading /js/socketevents.js...  done.</div><div class="result">Loading /js/customCommands.js...  done.</div><div class="result">Loading /js/utils.js...  done.</div><div class="result">Loading /js/constructors/Codemirror.js...  done.</div><div class="result">Loading /codemirrorlib/codemirror.js...  done.</div><div class="result" style="text-align: right;">OK Ready.</div><div class="promptContainer"><span class="prompt">localhost/todo<span class="arrow"></span></span><div class="input">save</div></div><div class="request" id="todo2" createdat="1484708741735">13.385 KB written successfully to todo.html at Tue Jan 17 2017 22:05:41 GMT-0500 (Eastern Standard Time)</div><div class="promptContainer"><span class="prompt">localhost/todo<span class="arrow"></span></span><div class="input"></div></div><div class="result">Loading /js/constructors/Leaf.js...  done.</div><div class="result">Loading /js/constructors/Terminal.js...  done.</div><div class="result">Loading /js/socket.io.js...  done.</div><div class="result">Loading /js/socketevents.js...  done.</div><div class="result">Loading /js/customCommands.js...  done.</div><div class="result">Loading /js/utils.js...  done.</div><div class="result">Loading /js/constructors/Codemirror.js...  done.</div><div class="result">Loading /codemirrorlib/codemirror.js...  done.</div><div class="result" style="text-align: right;">OK Ready.</div><div class="promptContainer"><span class="prompt">localhost/todo<span class="arrow"></span></span><div class="input">save</div></div><div class="request" id="todo2" createdat="1484708761075">14.444 KB written successfully to todo.html at Tue Jan 17 2017 22:06:01 GMT-0500 (Eastern Standard Time)</div><div class="promptContainer"><span class="prompt">localhost/todo<span class="arrow"></span></span><div class="input"></div></div></div></div>
  

<div showmenu="false" broadcast="true" listen="true" style="left: 556px; top: 449px; width: 800px; height: 400px; position: absolute; background: white;" tabindex="1" class="leaf codemirrorContainer        " id="Codemirror0"><div class="entityHeader">
    <table>
      <tbody><tr>
        <td class="headerTitle">Codemirror0</td>
      </tr>
    </tbody></table>
    <div class="menuButton"></div>
    <div class="removeButton"></div>
    <div class="menu">
      <ul>
        <li tabindex="2"> Edit <div class="editButton"></div></li>
        <li tabindex="2"> Broadcast <div class="broadcastButton"></div> </li>
        <li tabindex="2"> Listen <div class="listenButton"></div> </li>
        <li tabindex="2"> Save <div class="saveButton"></div> </li>
      </ul>
    </div>
  </div><textarea style="display: none;">Try to reorganize constructors to build their DOM dynamically into a shadowRoot.
Store state as JSON. Object manipulation is a million times faster than DOM manipulation anyway. negligble.
So the output history of terminals won't be fused to the HTML. On save, the prompt inputs can be committed to JSON, made an attribute of the node, and written to disk
When it's loaded, a fresh Terminal might be constructed, with the history of the object pulled into a script tag or however you want to do it. (would allow for precedural reconstructions of pages where changes were made that won't be reflected on state.)

For any component, top level DOM would only consist of custom tags

terminal
|_ codeMirror
|_ codeMirror
	|_transform
    	|_Tag
        
and so on, while the content is loaded into shadowRoots left and right. Should be clear separation of concerns.
Another option instead of in-lining JSON as attributes would be to save two files: DOM + JSON. This also approaches a stateful system that would be easier to version control and sync.Try out replacing the leaf constructor with a setup based around shadowRoots containing the entire component
So that when traversing the tree, only real component &lt;--&gt; component relationships are observed
</textarea></div><div showmenu="false" broadcast="true" listen="true" style="left: 55px; top: 270px; width: 800px; height: 400px; position: absolute; background: white;" tabindex="1" class="leaf codemirrorContainer                          " id="Codemirror1"><div class="entityHeader">
    <table>
      <tbody><tr>
        <td class="headerTitle">Codemirror1</td>
      </tr>
    </tbody></table>
    <div class="menuButton"></div>
    <div class="removeButton"></div>
    <div class="menu">
      <ul>
        <li tabindex="2"> Edit <div class="editButton"></div></li>
        <li tabindex="2"> Broadcast <div class="broadcastButton"></div> </li>
        <li tabindex="2"> Listen <div class="listenButton"></div> </li>
        <li tabindex="2"> Save <div class="saveButton"></div> </li>
      </ul>
    </div>
  </div><textarea style="display: none;">build scribe off of terminal
doesn't socketize until you commit to the transcription
add name as attribute, pull name from attribute, add socketized packets with their name.

disallow saving in the root directory if mode = production

api for serving a single node. play with mounting innerhtml and traversing nodes on the server. That'll be cool.
Set style to 100vw and 100vh, (shortcut for this also? button?). 
It's set to hash
open audio, images and video via tag
implement drag and drop uploading

Make video installing locally (with or without git)
Make video installing on AWS / Digital Ocean

tar.gz / zip. depending on whether client is unix or window
phantomjs - start playing with browser child process sending screenshot, allowing all clients to see the same page.

</textarea></div></body>